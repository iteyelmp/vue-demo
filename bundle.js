!function(e){var s={};function t(n){if(s[n])return s[n].exports;var a=s[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}t.m=e,t.c=s,t.d=function(e,s,n){t.o(e,s)||Object.defineProperty(e,s,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,s){if(1&s&&(e=t(e)),8&s)return e;if(4&s&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&s&&"string"!=typeof e)for(var a in e)t.d(n,a,function(s){return e[s]}.bind(null,a));return n},t.n=function(e){var s=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(s,"a",s),s},t.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)},t.p="",t(t.s=0)}([function(e,s,t){"use strict";t.r(s);var n=class{constructor(){this.listenFromIframe()}listenFromIframe(){window.addEventListener("message",async e=>{if(console.log("-----listenFromIframe-----",e),e&&e.data&&"LEDGER-IFRAME"===e.data.target){const{action:s,params:t}=e.data,n=s+"-reply";({"ledger-import":()=>this.import(n,t.hdPath),"ledger-unlock":()=>this.unlock(n,t.hdPath),"ledger-getAddress":()=>this.getAddress(n),"ledger-getAppConfiguration":()=>this.getAppConfiguration(n),"ledger-sign-transaction":()=>this.signTransaction(n,t.hdPath,t.serializedTxHex),"ledger-sign-personal-message":()=>this.signPersonalMessage(n,t.hdPath,t.message),undefined:()=>{}})[s]()}else console.log("not collwallet-iframe",e)},!1)}sendMessageToExtension(e){window.parent.postMessage(e,"*")}async initApp(){}cleanUp(){}async import(e,s){try{const s="0xC85d47b72cA69D2342426C7F1b0930a80178667C";this.sendMessageToExtension({action:e,success:!0,payload:s})}catch(s){const t=this.ledgerErrToMessage(s);this.sendMessageToExtension({action:e,success:!1,payload:{error:t.toString()}})}finally{this.cleanUp()}}async unlock(e,s){try{await this.initApp();const s="";this.sendMessageToExtension({action:e,success:!0,payload:s})}catch(s){const t=this.ledgerErrToMessage(s);this.sendMessageToExtension({action:e,success:!1,payload:{error:t.toString()}})}finally{this.cleanUp()}}async getAddress(e){try{await this.initApp();const{address:s}=await this.app.getAddress()||{};this.sendMessageToExtension({action:e,success:!0,payload:s})}catch(s){const t=this.ledgerErrToMessage(s);this.sendMessageToExtension({action:e,success:!1,payload:{error:t.toString()}})}finally{this.cleanUp()}}async getAppConfiguration(e){try{await this.initApp();const s={};this.sendMessageToExtension({action:e,success:!0,payload:s})}catch(s){const t=this.ledgerErrToMessage(s);this.sendMessageToExtension({action:e,success:!1,payload:{error:t.toString()}})}finally{this.cleanUp()}}async signTransaction(e,s,t){try{await this.initApp();const s="";this.sendMessageToExtension({action:e,success:!0,payload:s})}catch(s){const t=this.ledgerErrToMessage(s);this.sendMessageToExtension({action:e,success:!1,payload:{error:t.toString()}})}finally{this.cleanUp()}}async signPersonalMessage(e,s,t){try{await this.initApp();const s="";this.sendMessageToExtension({action:e,success:!0,payload:s})}catch(s){const t=this.ledgerErrToMessage(s);this.sendMessageToExtension({action:e,success:!1,payload:{error:t.toString()}})}finally{this.cleanUp()}}ledgerErrToMessage(e){return(e=>!!e&&!!e.metaData)(e)?5===e.metaData.code?"LEDGER_TIMEOUT":e.metaData.type:(e=>"string"==typeof e)(e)?e.includes("6804")?"LEDGER_WRONG_APP":e.includes("6801")?"LEDGER_LOCKED":e:(e=>e.hasOwnProperty("id")&&e.hasOwnProperty("message"))(e)&&e.message.includes("U2F not supported")?"U2F_NOT_SUPPORTED":e.toString()}};(async()=>{const e=new n;console.log("CoolWalletBridge",e)})(),console.log("QuarkChain < === > CoolWallet Bridge initialized!")}]);